with dataset as( SELECT prb_id ,"from",msm_id,  if (result[1].result[1].err is  null and result[1].result is not null ,transform(result , x -> transform (x.result, entry->  Map(array[ if (entry."from" is not null, concat('"',cast(entry."from" as varchar),'"') , concat('"','none','"')) ],  array[if (entry."from" is not null ,entry."rtt" ,0)]  ))),array[])  as datay from traceroutes_api where   "timestamp" >= {} and "timestamp"< {} and {}) select "from",prb_id,msm_id,datay as result from dataset;
